{% extends "base.html" %}

{% block title %}{{ _('settings_title') }} – PrintFleet{% endblock %}

{% block content %}
  <h2>{{ _('settings_title') }}</h2>

  {% if message %}
    <p style="color:green;">{{ _('settings_message_saved') }}</p>
  {% endif %}
  {% if error %}
    <p style="color:red;">{{ error }}</p>
  {% endif %}

  <form method="post">

    <div style="margin-bottom: 1rem;">
      <label for="poll_interval">
        {{ _('settings_poll_interval_label') }}*
      </label><br>
      <input
        type="number"
        step="0.1"
        min="0.1"
        id="poll_interval"
        name="poll_interval"
        value="{{ settings.poll_interval }}"
        title="{{ _('settings_poll_interval_help') }}"
      >
      <small>
        {{ _('settings_poll_interval_help') }}
      </small>
    </div>

    <div style="margin-bottom: 1rem;">
      <label for="db_reload_interval">
        {{ _('settings_db_reload_interval_label') }}*
      </label><br>
      <input
        type="number"
        step="1"
        min="5"
        id="db_reload_interval"
        name="db_reload_interval"
        value="{{ settings.db_reload_interval }}"
        title="{{ _('settings_db_reload_interval_help') }}"
      >
      <small>
        {{ _('settings_db_reload_interval_help') }}
      </small>
    </div>

    <div style="margin-bottom: 1rem;">
      <label for="telegram_chat_id">
        {{ _('settings_telegram_chat_id_label') }}
      </label><br>
      <input
        type="text"
        id="telegram_chat_id"
        name="telegram_chat_id"
        value="{{ settings.telegram_chat_id }}"
        title="{{ _('settings_telegram_chat_id_help') }}"
      >
      <small>
        {{ _('settings_telegram_chat_id_help') }}
      </small>
    </div>

    <div style="margin-bottom: 1rem;">
      <label for="language">
        {{ _('settings_language_label') }}
      </label><br>
      <select
        id="language"
        name="language"
        title="{{ _('settings_language_help') }}"
      >
        <option value="en" {% if settings.language == 'en' %}selected{% endif %}>English (en)</option>
        <option value="de" {% if settings.language == 'de' %}selected{% endif %}>Deutsch (de)</option>
        <option value="fr" {% if settings.language == 'fr' %}selected{% endif %}>Français (fr)</option>
        <option value="ru" {% if settings.language == 'ru' %}selected{% endif %}>Русский (ru)</option>
      </select>
      <small>
        {{ _('settings_language_help') }}
      </small>
    </div>

    <p>
    <!-- Speichern -->
    <button type="submit" class="btn">{{ _('settings_save_button') }}</button>

    <!-- Einstellungen exportieren -->
    <a href="{{ url_for('export.export_settings') }}" class="btn" style="margin-left: 1rem;">
        {{ _('btn_export_settings') }}
    </a>
</p>

  </form>
<h2>{{ _('settings_title_import') }}</h2>
  <!-- Import-Formular für Settings (eigenes Form, anderer Endpoint) -->
  <form
    method="post"
    action="{{ url_for('export.import_settings') }}"
    enctype="multipart/form-data"
    style="margin-top: 1rem;"
  >
    <input
      type="file"
      name="file"
      accept=".json"
      required
    >
    <button type="submit" class="btn">
      {{ _('btn_import_settings') }}
    </button>
  </form>
{% endblock %}